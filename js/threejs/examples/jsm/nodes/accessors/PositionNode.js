import{TempNode}from"../core/TempNode.js";import{NodeLib}from"../core/NodeLib.js";function PositionNode(o){TempNode.call(this,"v3"),this.scope=o||PositionNode.LOCAL}PositionNode.LOCAL="local",PositionNode.WORLD="world",PositionNode.VIEW="view",PositionNode.PROJECTION="projection",PositionNode.prototype=Object.create(TempNode.prototype),PositionNode.prototype.constructor=PositionNode,PositionNode.prototype.nodeType="Position",PositionNode.prototype.getType=function(){return this.scope===PositionNode.PROJECTION?"v4":this.type},PositionNode.prototype.getShared=function(){switch(this.scope){case PositionNode.LOCAL:case PositionNode.WORLD:return!1}return!0},PositionNode.prototype.generate=function(o,e){var i;switch(this.scope){case PositionNode.LOCAL:o.isShader("vertex")?i="transformed":(o.requires.position=!0,i="vPosition");break;case PositionNode.WORLD:if(o.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";o.requires.worldPosition=!0,i="vWPosition";break;case PositionNode.VIEW:i=o.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case PositionNode.PROJECTION:i=o.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return o.format(i,this.getType(o),e)},PositionNode.prototype.copy=function(o){return TempNode.prototype.copy.call(this,o),this.scope=o.scope,this},PositionNode.prototype.toJSON=function(o){var e=this.getJSONNode(o);return e||((e=this.createJSONNode(o)).scope=this.scope),e},NodeLib.addKeyword("position",(function(){return new PositionNode})),NodeLib.addKeyword("worldPosition",(function(){return new PositionNode(PositionNode.WORLD)})),NodeLib.addKeyword("viewPosition",(function(){return new PositionNode(PositionNode.VIEW)}));export{PositionNode};