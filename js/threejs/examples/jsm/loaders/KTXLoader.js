import{CompressedTextureLoader}from"../../../build/three.module.js";var KTXLoader=function(e){CompressedTextureLoader.call(this,e)};KTXLoader.prototype=Object.assign(Object.create(CompressedTextureLoader.prototype),{constructor:KTXLoader,parse:function(e,t){var r=new KhronosTextureContainer(e,1);return{mipmaps:r.mipmaps(t),width:r.pixelWidth,height:r.pixelHeight,format:r.glInternalFormat,isCubemap:6===r.numberOfFaces,mipmapCount:r.numberOfMipmapLevels}}});var KhronosTextureContainer=function(){function e(t,r){this.arrayBuffer=t;var i=new Uint8Array(this.arrayBuffer,0,12);if(171===i[0]&&75===i[1]&&84===i[2]&&88===i[3]&&32===i[4]&&49===i[5]&&49===i[6]&&187===i[7]&&13===i[8]&&10===i[9]&&26===i[10]&&10===i[11]){var a=Uint32Array.BYTES_PER_ELEMENT,n=new DataView(this.arrayBuffer,12,13*a),s=67305985===n.getUint32(0,!0);this.glType=n.getUint32(1*a,s),this.glTypeSize=n.getUint32(2*a,s),this.glFormat=n.getUint32(3*a,s),this.glInternalFormat=n.getUint32(4*a,s),this.glBaseInternalFormat=n.getUint32(5*a,s),this.pixelWidth=n.getUint32(6*a,s),this.pixelHeight=n.getUint32(7*a,s),this.pixelDepth=n.getUint32(8*a,s),this.numberOfArrayElements=n.getUint32(9*a,s),this.numberOfFaces=n.getUint32(10*a,s),this.numberOfMipmapLevels=n.getUint32(11*a,s),this.bytesOfKeyValueData=n.getUint32(12*a,s),0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===r?this.loadType=e.COMPRESSED_2D:console.warn("number of faces expected"+r+", but found "+this.numberOfFaces):console.warn("texture arrays not currently supported"):console.warn("only 2D textures currently supported")):console.warn("only compressed formats currently supported")}else console.error("texture missing KTX identifier")}return e.prototype.mipmaps=function(t){for(var r=[],i=e.HEADER_LEN+this.bytesOfKeyValueData,a=this.pixelWidth,n=this.pixelHeight,s=t?this.numberOfMipmapLevels:1,o=0;o<s;o++){var p=new Int32Array(this.arrayBuffer,i,1)[0];i+=4;for(var h=0;h<this.numberOfFaces;h++){var u=new Uint8Array(this.arrayBuffer,i,p);r.push({data:u,width:a,height:n}),i+=p,i+=3-(p+3)%4}a=Math.max(1,.5*a),n=Math.max(1,.5*n)}return r},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}();export{KTXLoader};