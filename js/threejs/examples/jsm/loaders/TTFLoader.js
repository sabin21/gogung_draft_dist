import{FileLoader,Loader}from"../../../build/three.module.js";var TTFLoader=function(e){Loader.call(this,e),this.reversed=!1};TTFLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:TTFLoader,load:function(e,o,a,n){var t=this,r=new FileLoader(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.load(e,(function(e){o(t.parse(e))}),a,n)},parse:function(e){function o(e){var o,a=[];e.forEach((function(e){"m"===e.type.toLowerCase()?(o=[e],a.push(o)):"z"!==e.type.toLowerCase()&&o.push(e)}));var n=[];return a.forEach((function(e){var o={type:"m",x:e[e.length-1].x,y:e[e.length-1].y};n.push(o);for(var a=e.length-1;a>0;a--){var t=e[a];o={type:t.type},void 0!==t.x2&&void 0!==t.y2?(o.x1=t.x2,o.y1=t.y2,o.x2=t.x1,o.y2=t.y1):void 0!==t.x1&&void 0!==t.y1&&(o.x1=t.x1,o.y1=t.y1),o.x=e[a-1].x,o.y=e[a-1].y,n.push(o)}})),n}return"undefined"==typeof opentype?(console.warn("THREE.TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(e,a){for(var n=Math.round,t={},r=1e5/(72*(e.unitsPerEm||2048)),i=e.encoding.cmap.glyphIndexMap,s=Object.keys(i),d=0;d<s.length;d++){var y=s[d],p=e.glyphs.glyphs[i[y]];if(void 0!==y){var h={ha:n(p.advanceWidth*r),x_min:n(p.xMin*r),x_max:n(p.xMax*r),o:""};a&&(p.path.commands=o(p.path.commands)),p.path.commands.forEach((function(e){"c"===e.type.toLowerCase()&&(e.type="b"),h.o+=e.type.toLowerCase()+" ",void 0!==e.x&&void 0!==e.y&&(h.o+=n(e.x*r)+" "+n(e.y*r)+" "),void 0!==e.x1&&void 0!==e.y1&&(h.o+=n(e.x1*r)+" "+n(e.y1*r)+" "),void 0!==e.x2&&void 0!==e.y2&&(h.o+=n(e.x2*r)+" "+n(e.y2*r)+" ")})),t[String.fromCodePoint(p.unicode)]=h}}return{glyphs:t,familyName:e.getEnglishName("fullName"),ascender:n(e.ascender*r),descender:n(e.descender*r),underlinePosition:e.tables.post.underlinePosition,underlineThickness:e.tables.post.underlineThickness,boundingBox:{xMin:e.tables.head.xMin,xMax:e.tables.head.xMax,yMin:e.tables.head.yMin,yMax:e.tables.head.yMax},resolution:1e3,original_font_information:e.tables.name}}(opentype.parse(e),this.reversed)}});export{TTFLoader};