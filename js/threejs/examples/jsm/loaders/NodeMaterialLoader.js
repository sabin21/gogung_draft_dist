import{DefaultLoadingManager,FileLoader}from"../../../build/three.module.js";import*as Nodes from"../nodes/Nodes.js";var NodeMaterialLoader=function(e,s){this.manager=void 0!==e?e:DefaultLoadingManager,this.nodes={},this.materials={},this.passes={},this.names={},this.library=s||{}},NodeMaterialLoaderUtils={replaceUUIDObject:function(e,s,t,a){if(a=void 0===a||a,"object"==typeof s&&(s=s.uuid),"object"==typeof e)for(var r=Object.keys(e),i=0;i<r.length;i++){var n=r[i];a&&(e[n]=this.replaceUUIDObject(e[n],s,t)),n===s&&(e[s]=e[n],delete e[n])}return e===s?t:e},replaceUUID:function(e,s,t){return this.replaceUUIDObject(e,s,t,!1),this.replaceUUIDObject(e.nodes,s,t),this.replaceUUIDObject(e.materials,s,t),this.replaceUUIDObject(e.passes,s,t),this.replaceUUIDObject(e.library,s,t,!1),e}};Object.assign(NodeMaterialLoader.prototype,{load:function(e,s,t,a){var r=this,i=new FileLoader(r.manager);return i.setPath(r.path),i.load(e,(function(e){s(r.parse(JSON.parse(e)))}),t,a),this},setPath:function(e){return this.path=e,this},getObjectByName:function(e){return this.names[e]},getObjectById:function(e){return this.library[e]||this.nodes[e]||this.materials[e]||this.passes[e]||this.names[e]},getNode:function(e){var s=this.getObjectById(e);return s||console.warn('Node "'+e+'" not found.'),s},resolve:function(e){switch(typeof e){case"boolean":case"number":return e;case"string":return/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/i.test(e)||this.library[e]?this.getNode(e):e;default:if(Array.isArray(e))for(var s=0;s<e.length;s++)e[s]=this.resolve(e[s]);else for(var t in e)"uuid"!==t&&(e[t]=this.resolve(e[t]))}return e},declare:function(e){var s,t,a;for(s in e.nodes)t=e.nodes[s],a=new Nodes[t.nodeType+"Node"],t.name&&(a.name=t.name,this.names[a.name]=a),this.nodes[s]=a;for(s in e.materials)t=e.materials[s],a=new Nodes[t.type],t.name&&(a.name=t.name,this.names[a.name]=a),this.materials[s]=a;for(s in e.passes)t=e.passes[s],a=new Nodes[t.type],t.name&&(a.name=t.name,this.names[a.name]=a),this.passes[s]=a;return e.material&&(this.material=this.materials[e.material]),e.pass&&(this.pass=this.passes[e.pass]),e},parse:function(e){var s;for(s in(e=this.resolve(this.declare(e))).nodes)this.nodes[s].copy(e.nodes[s]);for(s in e.materials)this.materials[s].copy(e.materials[s]);for(s in e.passes)this.passes[s].copy(e.passes[s]);return this.material||this.pass||this}});export{NodeMaterialLoader,NodeMaterialLoaderUtils};